<h1>INDIA RE CHALLENGE (PENTEST HUB 2019)</h1>

>This Challenge Is Pretty Easy If You Familiar With IDA.

>If You Decompile the main function you will get the c code. Let take a look. As you can see our input is keep in v15 and 
check if it is between  0x98967F and 0x5F5E0FF. And it make some calculation with our password and keep in v14 which use 
to dectypt the flag. It is simple Xor encryption.

```c

int __cdecl main(int argc, const char **argv, const char **envp)
{
  const char **v3; // ST1C_4
  int result; // eax
  int v5; // [esp-14h] [ebp-40h]
  int v6; // [esp-10h] [ebp-3Ch]
  int v7; // [esp-Ch] [ebp-38h]
  int v8; // [esp-8h] [ebp-34h]
  int v9; // [esp-4h] [ebp-30h]
  int v10; // [esp+4h] [ebp-28h]
  int v11; // [esp+8h] [ebp-24h]
  int i; // [esp+8h] [ebp-24h]
  int v13; // [esp+10h] [ebp-1Ch]
  int v14; // [esp+10h] [ebp-1Ch]
  unsigned __int64 v15; // [esp+14h] [ebp-18h]
  __int64 v16; // [esp+1Ch] [ebp-10h]
  int *v17; // [esp+24h] [ebp-8h]

  v17 = &argc;
  v3 = argv;
  HIDWORD(v16) = __readgsdword(0x14u);
  v15 = 0LL;
  puts("Try your luck ;)\n");
  printf("Enter secret 8 digit code to get key : ");
  __isoc99_scanf("%llu", &v15, v5, v6, v7, v8, v9, v3, v10, v11, 0, v13);
  if ( v15 > 0x98967F && v15 <= 0x5F5E0FF )
  {
    v16 = 10LL;
    v14 = v15 % 0xA * (v15 % 0xA) - v15 % 0xA - 3 * (v15 % 0xA);
    puts("Getting your flag... \n");
    for ( i = 0; i < len; ++i )
      f[i] ^= v14;
    puts(f);
    result = 0;
  }
  else
  {
    printf("Somehow you seem to be more stupid than I thought.");
    result = 0;
  }
  return result;
}
```


>If we click on f[] in decompile code we will see that the hardcoded Encrypted flag. We know the flag Format and it msut be
Flag{...}. 

```
; char f[24]
.data:56612008 f               db 4Ah, 60h, 6Dh, 6Bh, 77h, 5Eh, 49h, 53h, 45h, 7Fh, 53h
.data:56612008                                         ; DATA XREF: main:loc_56610714↑o
.data:56612008                                         ; main+12C↑o ...
.data:56612008                 db 49h, 38h, 5Fh, 55h, 53h, 5Eh, 45h, 4Bh, 44h, 58h, 33h
.data:56612008                 db 71h, 0

```

> Above is encrypted flag so we can calculate the XOR key and use to decrypt it. Xor key is ***0xC*** and Flag is ***Flag{RE_Is_E4SY_RIGHT?}***
